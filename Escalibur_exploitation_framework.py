# post_exploitation_framework.py

import subprocess
import os

def execute_command(command):
    try:
        result = subprocess.check_output(command, shell=True, stderr=subprocess.STDOUT)
        return result.decode()
    except Exception as e:
        return str(e)

def list_files(directory="."):
    try:
        files = os.listdir(directory)
        return "\n".join(files)
    except Exception as e:
        return str(e)

def show_system_info():
    try:
        uname = execute_command("uname -a")
        hostname = execute_command("hostname")
        ip_address = execute_command("hostname -I")
        return f"Hostname: {hostname}\nIP Address: {ip_address}\nSystem Info: {uname}"
    except Exception as e:
        return str(e)

def escalate_privileges():
    try:
        if os.getuid() != 0:
            return execute_command("sudo -l")
        else:
            return "Already running with root privileges."
    except Exception as e:
        return str(e)

def main():
    print("Welcome to Post-Exploitation Framework!")
    print("Type 'help' to see available commands.")

    while True:
        user_input = input("> ")
        if user_input.lower() == "exit":
            print("Exiting...")
            break
        elif user_input.lower() == "help":
            print("Available commands:")
            print(" - execute <command>: Execute a shell command")
            print(" - list_files [<directory>]: List files in the current directory or specified directory")
            print(" - system_info: Show system information")
            print(" - escalate_privileges: Attempt to escalate privileges")
            print(" - exit: Exit the framework")
        elif user_input.startswith("execute"):
            command = user_input.split(" ", 1)[1]
            output = execute_command(command)
            print(output)
        elif user_input.startswith("list_files"):
            directory = user_input.split(" ", 1)[1] if len(user_input.split(" ")) > 1 else "."
            output = list_files(directory)
            print(output)
        elif user_input.lower() == "system_info":
            output = show_system_info()
            print(output)
        elif user_input.lower() == "escalate_privileges":
            output = escalate_privileges()
            print(output)
        else:
            print("Invalid command. Type 'help' for available commands.")

if __name__ == "__main__":
    main()
